(function(a){a.accelerometerSlider=function(i,p){var f={on:"orientation",orientation:"west",minGamma:25,resetGamma:15,sensibility:4,minTime:500,callback:null,images:null,effect:"fade",effectDuration:500,movePercent:20,responsive:false,responsiveSpeed:200,responsiveWidth:"",responsiveHeight:"",acceleration:true,exclude:".slider-content"};var k=this;k.data;k.settings={};var o=a(i),i=i;k.init=function(){k.settings=a.extend({},f,p);k.data={inSwipe:false,pos:0,lastAction:0,lastTime:0,eventHandler:null,mouseDown:0,mouseUp:0,scrollY:0,use3D:true,useComplex3D:true,prefix:""};k.data.prefix=c();k.data.use3D=k.settings.acceleration&&(k.data.prefix!="no");k.data.useComplex3D=navigator.userAgent.toLowerCase().indexOf("android")<0;var q=l(o);o.css({position:"relative",overflow:"hidden"});var r=0;o.children().not(k.settings.exclude).each(function(){var s=a(this);s.css({cursor:"move","background-color":q});if(r>0){s.hide()}r++});e()};k.size=function(){return o.children().not(k.settings.exclude).length};k.prev=function(){k.swipe(-1)};k.next=function(){k.swipe(1)};k.position=function(){return k.data.pos};k.current=function(){var q=o.children().not(k.settings.exclude).get();return q[k.data.pos]};k.swipe=function(v,u){if(k.data.inSwipe){return}var s=o.children().not(k.settings.exclude).get();var q=s.length;if(q<2){return}k.data.inSwipe=true;var B=k.data.pos;k.data.pos+=v>0?1:-1;var C=v>0?-1:1;k.data.pos=k.data.pos>q-1?0:k.data.pos<0?q-1:k.data.pos;var z;var y=s[B];var w=s[k.data.pos];var E=a(y).outerHeight();var r=a(y).outerWidth();k.data.height=a(w).outerHeight();k.data.width=a(w).outerWidth();switch(k.settings.effect){case"fade":z={current:{finish:{opacity:0}},next:{start:{position:"absolute",top:"0px",left:"0px",opacity:0,width:r+"px",height:E+"px",display:"block"},finish:{opacity:1}}};k.startSwipe({current:y,next:w,props:z,accelerate:k.data.use3D});break;case"slidein":var t=r*C;z={current:{start:{position:"relative",top:"0px",left:"0px","z-index":"1"},finish:{left:"0px"},},next:{start:{position:"absolute",top:"0px",left:t+"px",width:r+"px",height:E+"px",display:"block","z-index":"10"},finish:{left:"0px"},transform:"translate3d("+(-t)+"px,0px,0px)"}};k.startSwipe({current:y,next:w,props:z,accelerate:k.data.use3D});break;case"slideinout":z={current:{start:{position:"relative",top:"0px",left:"0px"},finish:{left:(r*C*-1)+"px"},transform:"translate3d("+(r*C*-1)+"px,0,0)"},next:{start:{position:"absolute",top:"0px",left:(r*C-3*C)+"px",width:r+"px",height:E+"px",display:"block"},finish:{left:"0px"},transform:"translate3d("+(r*C*-1)+"px,0px,0px)"}};k.startSwipe({current:y,next:w,props:z,accelerate:k.data.use3D});break;case"toss":var A=o.offset().top-a(window).scrollTop();var t=o.offset().left-a(window).scrollLeft();var x=(t-r)*C;var D=(A-E)*C;z={apply:true,current:{start:{position:"fixed",left:t+"px",top:A+"px",width:r+"px",height:E+"px",opacity:"1"},finish:{opacity:"0",left:x+"px",top:D+"px"},transform:"translate3d("+x+"px,"+D+"px,0px)"},next:{start:{position:"static",left:"0px",top:"0px",opacity:"0",display:"block"},finish:{opacity:"1"},transform:"translate3d(0px,0px,0px)"}};k.startSwipe({current:y,next:w,props:z,accelerate:k.data.use3D});break}k.data.lastAction=v;k.data.lastTime=u?u:Date.now()};k.startSwipe=function(s){var s=a.extend({current:null,next:null,props:null,accelerate:true,duration:-1,callback:null,},s);var u=s.duration>-1?s.duration:k.settings.effectDuration;var t=s.accelerate&&((s.props.current&&s.props.current.transform)||(s.props.next&&s.props.next.transform));if(t){if(s.props.current){delete s.props.current.finish.left}if(s.props.current){delete s.props.current.finish.top}if(s.props.next){delete s.props.next.finish.left}if(s.props.next){delete s.props.next.finish.top}var r=s.props.apply?s.props.current.finish:null;var q=s.props.apply&&s.props.next?s.props.next.finish:null;if(s.props.current&&s.props.current.start){b(s.current,s.props.current.start,s.duration)}if(s.props.next&&s.props.next.start){b(s.next,s.props.next.start,s.duration)}if(s.props.current){n(s.current,r,s.props.current.transform)}if(s.props.next){n(s.next,q,s.props.next.transform)}if(s.duration<0||s.callback!=null&&!s.done){h(s.current,s.next,s.callback)}}else{if(s.props.current&&s.props.current.start){m(s.current,s.props.current.start)}if(s.props.next&&s.props.next.start){m(s.next,s.props.next.start)}if(s.props.current){j(s.current,null,s.props.current.finish,s.duration)}if(s.props.next){j(s.current,s.next,s.props.next.finish,s.duration)}}return t};k.responsive=function(u,s,q,v){var r={apply:true,current:{start:{position:"relative",left:"0px",top:"0px"},finish:{width:s+"px",height:q+"px"},transform:"translate3d(0px,0px,0px)"}};var t=k.startSwipe({current:u,props:r,accelerate:k.data.use3D,duration:v});if(t){a(u).bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){var w={};w[k.data.prefix+"transition-property"]="none";w[k.data.prefix+"transition-duration"]="";w[k.data.prefix+"transition-timing-function"]="";w[k.data.prefix+"transform"]="";a(u).css(w).css({position:"static",height:k.settings.responsiveWidth,width:k.settings.responsiveHeight});a(u).unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");k.data.inSwipe=false;if(k.settings.callback!=null&&typeof(k.settings.callback)==="function"){k.settings.callback.call()}})}};k.add=function(u,v){var t=v?v:k.data.pos;var q=l(o);a(u).css({cursor:"move","background-color":q,display:"none"}).addClass("last-inserted");var s=o.children(":not("+k.settings.exclude+")").get();if(s.length>0){a(s[t]).after(u)}else{o.prepend(u);a(u).show()}var r=o.find(".last-inserted").removeClass("last-inserted");e(r);if(r.prop("tagName")!="IMG"){if(!v&&s.length>0){k.swipe(1)}return s.length+1}r.css({width:k.data.width,height:k.data.height,});if(r.prop("complete")&&u.naturalWidth!=0){if(!v&&s.length>0){k.swipe(1)}}else{r.load(function(){if(!v&&s.length>0){k.swipe(1)}})}return s.length+1};k.remove=function(){var r=o.children().not(k.settings.exclude).get();var q=r.length;if(q<1){return 0}var t=r[k.data.pos];k.data.pos--;if(k.data.pos<0){k.data.pos=q-1}var s=r[k.data.pos];a(t).css({position:"absolute",top:0,left:0}).animate({opacity:0},k.settings.effectDuration,function(){a(t).remove()});a(s).css({position:"static",display:"block"});if(k.data.pos>0&&k.data.pos==q-1){k.data.pos--}return q-1};k.destroy=function(){if(k.data.eventHandler){window.removeEventListener("devicemotion deviceorientation",k.data.eventHandler,true)}o.children().unbind("mousedown touchstart touchmove mouseup touchend").css("cursor","")};var n=function(s,r,q){var t=a(s);var u={};u[k.data.prefix+"transform"]=q;if(r!=null){t.css(r)}t.css(u)};var b=function(s,r,v){v=v>-1?v:k.settings.effectDuration;var w={};w[k.data.prefix+"transition-property"]="all";w[k.data.prefix+"transition-duration"]=v+"ms";w[k.data.prefix+"transition-timing-function"]="ease-in-out";var u=a(s);if(r!=null){u.css(r)}try{var q=window.getComputedStyle(s,null);for(var x in r){u.css(x,q.getPropertyValue(x))}}catch(t){}u.css(w)};var m=function(r,q){var s=a(r);if(q!=null){s.css(q)}};var j=function(v,r,q,s){var u=r!=null?a(r):a(v);var t=s>-1?s:k.settings.effectDuration;u.animate(q,t,function(){if(k.settings.responsive&&(s<0&&r!=null)){if(v!=null&&r!=null){a(v).css("display","none")}k.responsive(u,k.data.width,k.data.height,k.settings.responsiveSpeed)}else{if(s>-1){return}if(v!=null){a(v).css(q).css("display","none")}if(r!=null){u.css(q).css("position","static")}if(r!=null&&k.settings.responsive){u.css({height:k.settings.responsiveWidth,width:k.settings.responsiveHeight})}if(k.settings.callback!=null&&typeof(k.settings.callback)==="function"){k.settings.callback.call()}}k.data.inSwipe=false})};var h=function(s,r,t){if(t!=null){var q=r!=null?a(r):a(s);q.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",t)}else{a(r).bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){var u={};u[k.data.prefix+"transition-property"]="none";u[k.data.prefix+"transition-duration"]="";u[k.data.prefix+"transition-timing-function"]="";u[k.data.prefix+"transform"]="";if(s!=null){a(s).css(u).css("display","none")}a(r).css(u).css({position:"static"});if(k.settings.responsive){k.responsive(r,k.data.width,k.data.height,k.settings.responsiveSpeed)}else{a(r).unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");if(k.settings.callback!=null&&typeof(k.settings.callback)==="function"){k.settings.callback.call()}k.data.inSwipe=false}})}};var e=function(r){k.data.lastTime=Date.now();var q=r?r:o.children();q.each(function(){a(this).bind("mousedown touchstart",function(s){if(s.originalEvent.touches){k.data.mouseDown=s.originalEvent.touches[0].pageX;k.data.scrollY=s.originalEvent.touches[0].pageY}else{k.data.mouseDown=s.pageX;k.data.scrollY=s.pageY;s.stopPropagation();return false}}).bind("touchmove",function(t){k.data.mouseUp=t.originalEvent.touches[0].pageX;var s=t.originalEvent.touches[0].pageY;if(Math.abs(k.data.mouseUp-k.data.mouseDown)>Math.abs(s-k.data.scrollY)){t.stopPropagation();return false}}).bind("mouseup touchend",function(u){if(!u.originalEvent.touches){k.data.mouseUp=u.pageX}var s=k.data.mouseUp-k.data.mouseDown;var t=o.outerWidth();var v=k.settings.movePercent*t/100;if(Math.abs(s)>v){k.swipe(s,0);u.preventDefault();return false}}).bind("dragstart",function(s){s.preventDefault()})});if(k.settings.on=="orientation"&&!r){window.addEventListener("deviceorientation",k.data.eventHandler=function(t){var s=k.settings.orientation=="west"?t.gamma:t.beta;var u=Date.now();if(u-k.data.lastTime<k.settings.minTime){return false}if(s>=-k.settings.resetGamma&&s<=k.settings.resetGamma){k.data.lastAction=0}if(k.data.lastAction<=-k.settings.minGamma&&s<=-k.settings.minGamma){return}if(k.data.lastAction>=k.settings.minGamma&&s>=k.settings.minGamma){return}if(s>=k.settings.minGamma||s<=-k.settings.minGamma){k.swipe(s,u)}return true},true)}else{if(k.settings.on=="motion"&&!r){window.ondevicemotion=function(t){var s=t.acceleration.x;var u=Date.now();if(u-k.settings.lastTime<k.settings.minTime){return false}if(s>=k.settings.sensibility||s<=-k.settings.sensibility){k.swipe(s,u)}}}}return k.data};var c=function(){var q=d();if(q.msie&&q.version<10){return"no"}if(q.opera&&q.version<15){return"no"}var v=document.createElement("div"),t=["-webkit-","-moz-","-o-",""],r=t.length,s;while(r--){s=t[r];try{v.style.cssText=s.toLowerCase()+"transform:translate3d(0,0,0);";if(typeof v.style[s+"transform"]!="undefined"){return s}}catch(u){}}return"no"};var l=function(r){var q=r.css("background-color");if(q.length==0){q=r.css("background")}if(q=="rgba(0, 0, 0, 0)"||q=="transparent"){q=""}if(q.length>0||r.is("body")){return q}else{return l(r.parent())}};var g=function(r){r=r.toLowerCase();var q=/(chrome)[ \/]([\w.]+)/.exec(r)||/(webkit)[ \/]([\w.]+)/.exec(r)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(r)||/(msie) ([\w.]+)/.exec(r)||r.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(r)||[];return{browser:q[1]||"",version:q[2]||"0"}};var d=function(){var q=g(navigator.userAgent);var r={};if(q.browser){r[q.browser]=true;r.version=q.version}if(r.chrome){r.webkit=true}else{if(r.webkit){r.safari=true}}return r};k.init()};a.fn.accelerometerSlider=function(b){return this.each(function(){if(undefined==a(this).data("accelerometerSlider")){var c=new a.accelerometerSlider(this,b);a(this).data("accelerometerSlider",c)}})}})(jQuery);
